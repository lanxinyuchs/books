%%----------------------------------------------------------------------
%%
%% %EricssonCopyright%
%% %CopyrightBegin%
%% 
%% Copyright Ericsson AB 2012. All Rights Reserved.
%% 
%% The program may be used and/or copied only with the written permission from
%% Ericsson AB, or in accordance with the terms and conditions stipulated in
%% the agreement/contract under which the program has been supplied.
%% 
%% %CopyrightEnd%
%%
%%-----------------------------------------------------------------
%% File: safs_com_insup.erl
%% 
%% Description:
%%    This file contains the communication supervisor which
%%    holds all active "in proxies"
%%
%%-----------------------------------------------------------------
-module(safs_com_insup).
-behaviour(supervisor).

%%--------------------------------------------------------------------
%% Include files
%%--------------------------------------------------------------------
-include("safs_internal.hrl").

%%-----------------------------------------------------------------
%% External exports
%%-----------------------------------------------------------------
-export([
	 start/2, 
	 start_connection/2
	]).

%%-----------------------------------------------------------------
%% Internal exports
%%-----------------------------------------------------------------
-export([
	 init/1, 
	 terminate/2
	]).

%%--------------------------------------------------------------------
%% Macros
%%--------------------------------------------------------------------

%%--------------------------------------------------------------------
%% Records
%%--------------------------------------------------------------------

%%====================================================================
%% External functions
%%====================================================================
%%--------------------------------------------------------------------
%% Function: start/2
%% Description: Starts the ...
%%--------------------------------------------------------------------
start(sup, Opts) ->
    supervisor:start_link({local, safs_com_insup}, ?MODULE,
			  {sup, Opts}).

%%-----------------------------------------------------------------
%% Func: start_connection/2
%%-----------------------------------------------------------------
start_connection(Type, Socket) ->
    supervisor:start_child(safs_com_insup, [{connect, Type, Socket}]).


%%====================================================================
%% Server functions
%%====================================================================
%%-----------------------------------------------------------------
%% Func: init/1
%%-----------------------------------------------------------------
init({sup, _Opts}) ->
    SupFlags = {simple_one_for_one, 500, 100},
    ChildSpec = [
		 {name1, {safs_com_inproxy, start, []}, temporary, 
		  10000, worker, [safs_com_inproxy]}
		],
    {ok, {SupFlags, ChildSpec}}.


%%-----------------------------------------------------------------
%% Func: terminate/1
%%-----------------------------------------------------------------
terminate(_Reason, _State) ->
    ok.


%%======================================================================
%% Internal functions
%%======================================================================


%%----------------------------------------------------------------------
%% END OF MODULE
%%----------------------------------------------------------------------


