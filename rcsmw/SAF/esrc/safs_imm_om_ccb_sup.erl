%%----------------------------------------------------------------------
%%
%% %EricssonCopyright%
%% %CopyrightBegin%
%% 
%% Copyright Ericsson AB 2012. All Rights Reserved.
%% 
%% The program may be used and/or copied only with the written permission from
%% Ericsson AB, or in accordance with the terms and conditions stipulated in
%% the agreement/contract under which the program has been supplied.
%% 
%% %CopyrightEnd%
%%
%%--------------------------------------------------------------------
%% File: safs_imm_om_ccb_sup.erl
%%
%% Description:
%%    This file contains the CCB supervisor which holds all active CCB's
%%
%%--------------------------------------------------------------------
-module(safs_imm_om_ccb_sup).
-behaviour(supervisor).

%%--------------------------------------------------------------------
%% Include files
%%--------------------------------------------------------------------
-include("safs_internal.hrl").

%%--------------------------------------------------------------------
%% External exports
%%--------------------------------------------------------------------
-export([
	 start/1,
	 start_ccb/1,
	 start_ccb/3
	]).

%%--------------------------------------------------------------------
%% Internal exports
%%--------------------------------------------------------------------
-export([
	 init/1,
	 terminate/2
	]).

%%--------------------------------------------------------------------
%% Macros
%%--------------------------------------------------------------------

%%--------------------------------------------------------------------
%% Records
%%--------------------------------------------------------------------

%%====================================================================
%% External functions
%%====================================================================
%%--------------------------------------------------------------------
%% Function: start_sup/1
%% Description:
%%--------------------------------------------------------------------
start(Opts) ->
    supervisor:start_link({local, safs_imm_om_ccb_sup}, ?MODULE,
			  {sup, Opts}).

%%-----------------------------------------------------------------
%% Func: start_ccb/3
%% esc: Used for starting a normal CCB
%%-----------------------------------------------------------------
start_ccb(CcbId, OwnerHandle, CcbFlags) ->
    supervisor:start_child(safs_imm_om_ccb_sup, [{initialize, CcbId, OwnerHandle, CcbFlags}]).

%%-----------------------------------------------------------------
%% Func: start_ccb/1
%% Desc: Used for starting an augmented CCB
%%-----------------------------------------------------------------
start_ccb(CcbId) ->
    supervisor:start_child(safs_imm_om_ccb_sup, [{initialize, CcbId}]).

%%====================================================================
%% Server functions
%%====================================================================
%%----------------------------------------------------------------------
%% Func: init/1
%%----------------------------------------------------------------------
init({sup, _}) ->

    SupFlags = {simple_one_for_one, 500, 100},
    ChildSpec = [
		 {name1, {safs_imm_om_ccb, initialize, []}, temporary, 
		  10000, worker, [safs_imm_om_ccb]}
		],
    {ok, {SupFlags, ChildSpec}}.

%%----------------------------------------------------------------------
%% Func: terminate/2
%%----------------------------------------------------------------------
terminate(_Reason, _State) ->
    ok.


%%======================================================================
%% Internal functions
%%======================================================================


%%----------------------------------------------------------------------
%% END OF MODULE
%%----------------------------------------------------------------------


